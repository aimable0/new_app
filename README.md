# BookSwap (SwapBook) — Flutter

A simple community app for students to swap books. This repository contains a Flutter app that uses Firebase for authentication and Firestore for data (users, swaps, messages).

## What this app does
- Email/password authentication (with email verification)
- User profiles with display name and settings
- Browse and list books (app screens under `lib/screens`)
- Swap requests and in-app chat (Firestore collections: `swaps` and nested `messages`)

## Quick start (Windows / PowerShell)
1. Install Flutter and set up your environment: https://flutter.dev/docs/get-started/install
2. Clone the repo and open it:

	```powershell
	cd C:\flutter_projects
	git clone <your-repo-url> new_app
	cd new_app
	```

3. Install dependencies and generate files:

	```powershell
	flutter pub get
	```

4. Firebase config: this project expects the Firebase options to be in `lib/firebase_options.dart` (generated by `flutterfire configure`). If you haven't already configured Firebase for Android/iOS/web, follow the Firebase setup steps and add the generated `firebase_options.dart` to `lib/`.

5. Run the app on an emulator or device:

	```powershell
	flutter run -d <device-id>
	```

## Important notes & common runtime warnings
- App Check: you may see warnings like `No AppCheckProvider installed.` — this is informational. App Check is optional. If you want to enable it for production, install and initialize `firebase_app_check` and register a provider (or use the debug provider for development).
- reCAPTCHA / Phone Auth: phone auth and certain services may log reCAPTCHA-related warnings on emulators. Use real devices or the recommended Firebase test phone numbers when testing.
- If sign-out doesn't immediately navigate away from protected screens, the app now navigates explicitly after successful sign-in/sign-out in the welcome/profile screens. The top-level `authProvider` still updates app state.

## Key files
- `lib/main.dart` — app entry and top-level routing that listens to auth state
- `lib/services/auth_service.dart` — sign in / sign up / sign out helpers (with debug logs)
- `lib/screens/welcome/` — sign in / sign up flows
- `lib/screens/profile/profile.dart` — user profile screen and logout button
- `lib/screens/chat/chat_screen.dart` — chat and chat room UI (uses Firestore `swaps` -> `messages`)
- `lib/firebase_options.dart` — generated Firebase config (not checked in by default)

## Running analyzer and tests
- To run the analyzer locally:

  ```powershell
  flutter analyze
  ```

## Troubleshooting
- If you see immediate re-login after sign-out in logs, check for background code that might call sign-in. I added debug prints in `AuthService.signOut` and `AuthService.signIn` to help see before/after states and sign-in attempts in the console.
- If you run into a `RenderFlex overflowed` error in chat screens (column overflow), the chat empty-state was updated to avoid that by using a compact column and accounting for keyboard insets.

## Contributing
- Small fixes and PRs welcome. Open an issue or PR if you find a bug or want a feature.